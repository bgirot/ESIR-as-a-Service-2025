theme: dark

server:
  address: tcp://:9091  # Port interne

log:
  level: info

jwt_secret: secret de bz
default_redirection_url: https://esir.komquest.cc

# Gestion sessions
session:
  name: authelia_session
  secret: je suis bete
  expiration: 1h
  inactivity: 5m
  domain: komquest.cc

# storage
storage:
  encryption_key: nan nan nan!!
  local:
    path: /config/db.sqlite3

# auth
authentication_backend:
  file:
    path: /config/users_database.yml

access_control:
  default_policy: deny
  rules:
    # tlm peut voir la page d'auth
    - domain: "auth.komquest.cc"
      policy: bypass
    # mais faut un pwd pour voir le reste
    - domain: "*.komquest.cc"
      policy: one_factor

# Notifications (pour r√©initialiser le mdp, on simule l'envoi dans un fichier)
notifier:
  filesystem:
    filename: /config/notification.txt

# OIDC
identity_providers:
  oidc:
    hmac_secret: openssl rand -hex 32
    issuer_private_key: /config/oidc.key

    access_token_lifespan: 1h
    id_token_lifespan: 1h
    refresh_token_lifespan: 90m

    clients:
      - id: vocechat
        description: VoceChat
        secret: '$pbkdf2-sha512$...' 
        public: false
        authorization_policy: one_factor
        redirect_uris:
          - https://chat.komquest.cc/api/admin/system/third_party_login/callback
        scopes:
          - openid
          - profile
          - email
        userinfo_signing_algorithm: none